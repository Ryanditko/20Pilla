document.getElementById("newsletter-form").addEventListener("submit", function(event) {
  event.preventDefault();

  const email = document.getElementById("email").value;
  const url = "https://script.google.com/macros/s/AKfycbwLcEoMdE6hKCunQSbVC2O7woafNoyJSW053-qI39RJzvEZql1BxGVb8-X_WIBMW16E/exec" + encodeURIComponent(email);


  const formData = new URLSearchParams();
  formData.append("email", email);

  fetch(url, {
    method: "POST",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: formData.toString()
  })
  .then(response => response.text())
  .then(text => {
    if (text.toLowerCase().includes("sucesso")) {
      alert("üéâ Cadastro realizado com sucesso!");
      document.getElementById("newsletter-form").reset();
    } else {
      alert("‚ö†Ô∏è Algo deu errado: " + text);
    }
  })
  .catch(error => {
    console.error(error);
    alert("‚ùå Ocorreu um erro. Tente novamente.");
  });
});

//function doPost(e) {
    //var sheet = SpreadsheetApp.openById("1AffemlcmQDTGBuqNPqGYhJNJJwzsWAXsRovBOXFX4P4").getSheetByName("P√°gina1");//

   // var email = e.parameter.email;
   // var data = new Date();//
  
   // sheet.appendRow([email, data]);//
  
    //return ContentService.createTextOutput("Cadastro realizado com sucesso!");
  //}//
  
  //function enviarEmails() {
    // var sheet = SpreadsheetApp.openById("1AffemlcmQDTGBuqNPqGYhJNJJwzsWAXsRovBOXFX4P4").getSheetByName("P√°gina1");
    // var dados = sheet.getRange("A2:A" + sheet.getLastRow()).getValues();
    // var assunto = "Novidades da 20Pilla!";
    // var mensagem = "Ol√°! Aqui est√£o as √∫ltimas novidades. Fique ligado! üíú";//
  
    //dados.forEach(function(linha) {
    //   var email = linha[0];
    //   if (email) {
        // MailApp.sendEmail(email, assunto, mensagem);
    //   }
    // });//
  //} //
  